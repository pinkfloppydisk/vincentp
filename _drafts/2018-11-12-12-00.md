---
layout: "post"
title: "Implementing the Indieweb using a static server and Netlify"
date: "2018-11-12 12:00:00 +/-GMT"
meta:  "Implementing the Indieweb using a static server"
summary: "Implementing the Indieweb using a static server"
category: "Articles"
modified :
modifiedReason:
twitterCard: true
tags: "indieweb jekyll thoughts technology webmention"
---

## Jump to the main things

- [Basic theory](#basic-theory)
- [Micropub](#micropub)
- [Backfeed](#backfeed)
- [Receiving Webmentions](#receiving-webmentions)
- [Sending Webmentions](#sending-webmentions)

ALSO DIAGRAMS

## IndieWeb

The [IndieWeb](https://indieweb.org/){:rel="external"} is a collection of web technologies actively being worked on to share content between websites and break out from the silo'ed social design you may be [familiar](https://www.twitter.com){:rel="external"} [with](https://facebook.com){:rel="external"}.

All you need to join the [IndieWeb](https://indieweb.org/){:rel="external"} is a Website and a URL then you can get involved. In fact, If you run your blog on a common platform such as [Wordpress](https://www.wordpress.org){:rel="external"}, you might even find that it is already supported.

This post focuses on how I implemented the following collection of IndieWeb technologies on my static site.

- <abbr title="Post Own Site Syndicate Elsewhere">POSSE</abbr>[^1]
- <abbr title="Post Elsewhere Syndicate Own Site">PESOS</abbr>[^2]
- Webmention[^3]

## Basic theory

I like to keep things simple. It's no secret that IndieWeb technologies can get complicated. I decided that all approaches must respect my current blog pattern.

1. Post a file in to Github.
2. Posting a file will cause the Netlify Webhook[^4] to activate and pull the code on to their servers which causes a rebuild and deploy.
3. Avoid client-side JavaScript. Everything is supposed to be static, lets keep it that way, it's much easier to cache for Service Workers, and reduces potential errors.
4. Platform agnostic. I don't want any logic responsible for IndieWeb technologies tied together with my blogging platform. Blogs are in markdown to keep them portable to any platform, so let's keep it that way.

With this format decided it becomes clear that another actor is required.

The blog has no real dynamic aspect other than templates. Thus we need something that captures the data, transforms it in to what we need and pushes it in to the Github API. Upon pushing the content in to the Github API, this will trigger a rebuild and deploy the site cleanly with no intermediate action needed. Nice!

I am most comfortable with [Node.JS](https://nodejs.org/){:rel="external"} (but the techniques I am going to describe can work in most languages) so I [spun up a server](https://mastr-cntrl.herokuapp.com){:rel="external"} on [Heroku](https://www.heroku.com){:rel="external"}. The very knowledgable [Phil Hawksworth](https://www.hawksworx.com/about){:rel="external"} pointed out recently I could possibly port this code to [Lambda](https://www.netlify.com/blog/2018/03/20/netlifys-aws-lambda-functions-bring-the-backend-to-your-frontend-workflow/){:rel="external"} functions and remove the Heroku dependency entirely. It's on the list for a future update and I would love to hear what other people think of this approach.

## Microformats

Before we delve deep in to the code its worth noting a few more important things. The IndieWeb is heavily dependant upon [Microformats](http://microformats.org){:rel="external"} and properly formed HTML. It is these tags it uses to work out what code is related to what. So spend time marking up your code correctly and read the [Indieweb Getting started guide](https://indieweb.org/Getting_Started){:rel="external"}. In particular focus on [h-card](http://microformats.org/wiki/h-card){:rel="external"} and [h-entry](http://microformats.org/wiki/h-entry){:rel="external"}.

## Security

One last note on security. If you are opening up your website to code from an external source make sure you can only let in the code you want. If a bad actor discovers your endpoint and can submit content easily they might spam your website and no one wants that.

Luckily the smart IndieWeb folk have thought of the first point, so make sure in all your dealings with external sources you use [IndieAuth](https://indieauth.com){:rel="external"}. You will see me mention IndieAuth a few times below. Get familiar with it and how it handles the token request. It's important you get this right.

It's also good practice to rate limit your endpoint. Since our IndieWeb server is a separate Microservice[^5] to our website we don't have to worry about a bad actor bringing our blog down, however we still need to protect our IndieWeb server from harm.

Finally. Don't store any of your keys in anything that can be traced such as Github. Learn about environmental variables and use something such as [dotenv](https://github.com/motdotla/dotenv#readme){:rel="external"}  to manage them.

## Micropub

### Media

### Syndication

Follow sending webmentions approach. Currently cheating using Zapier.

## Backfeed

Instagram, Swarm.

Be careful backfeeding webmentions from Brid.gy there may be GDPR implications. I am avoiding this practice in the short term, and only publishing Webmentions sent to me directly.

## Receiving Webmentions

## Sending Webmentions

how it works etc.

also mention 3rd party things to use Quill etc.



## Always more to do

- Storing Webmentions in one <abbr title="JavaScript Object Notation">JSON</abbr> file over time will cause build times to grow. It might be better to store Webmentions in a flat file alongside the post. I am still working on this solution, feel free to send your replies!
- Implement syndication the same as sending Webmentions.
- I would like to port the code over to Lambda functions in the future and remove the Heroku dependency.
- Moving to Eleventy next, this may change my implementation in some key ways. I'll update this post if that is the case.
- [IndieWeb Reader](https://indieweb.org/reader){:rel="external"}. This is my ultimate aim. I never stopped using feeds to consume content and have stuck with them. The IndieWeb Reader is bringing feeds back! I need to re-design my homepage to enrich my content through an indieweb reader.
- Content Sharding.

<div class="f-mono black f7 ttu" data-type="notes"><span>Notes</span></div>
[^1]: [POSSE](https://indieweb.org/POSSE){:rel="external"} Publish (on your) Own Site, Syndicate Elsewhere".
[^2]: [PESOS](https://indieweb.org/PESOS){:rel="external"} Publish Elsewhere, Syndicate (to your) Own Site".
[^3]: [Webmention](https://indieweb.org/Webmention){:rel="external"} is a web standard for mentions and conversations across the web".
[^4]: [Microservices](https://zapier.com/blog/what-are-webhooks/){:rel="external"} are an architectural style that structures an application as a collection of loosely coupled services, rather than one monolithic service.
[^5]: A [Webhook](https://en.wikipedia.org/wiki/Microservices){:rel="external"} is a way your website can communicate with another to prompt and action or share information.
